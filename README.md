# Satcoin
This is a fork for of Jonathan Heusser's repository: https://github.com/jheusser/satcoin 
Originally by Heusser, it was a proof of concept code, made for the following article: [bitcoin mining using SAT solver article](http://jheusser.github.com/2013/02/03/satcoin.html)

## Branches

The branch: original_heusser_imp_incremental_nonce introduces a version of satcoin which uses incremented values for the nonce, instead of a non-deterministic value.
The branch: original_heusser_imp introduces a version of satcoin which is the same as Heusser's original, but contains more blocks, and the assertion is modified.
The branch: original_heusser_imp_reduced_rounds introduces a version of satcoin which tested reduced versions of SHA256. By default it is set to 16 rounds. Main loop, line 70.


## Usage

The C file `satcoin.c` can be run in two modes.

### Compilation mode

The compilation can be used to verify that the hash calculation is actually performed correctly.

To execute in compilation mode, run the following command:

```
$ gcc satcoin.c -o satcoin
$ ./satcoin or satcoin.exe
```

Then you get the hash of your hard-coded block. E.g: in case of the genesis block it's the following:

00-00-00-00-00-19-d6-68-9c-08-5a-e1-65-83-1e-93-4f-f7-63-ae-46-a2-a6-c1-72-b3-f1-b6-0a-8c-e2-6f

### SAT mode

CBMC will utilize SAT solvers to analyze the program. The idea is to direct CBMC to search for the nonce which will produce a valid hash for the tested block.<br>
To run CBMC, you need to install it first: https://www.cprover.org/cbmc/ <br>
Please note, that Linux users can install CBMC with the command: "sudo apt install cbmc" but this will install an older version.<br>
Also, Linux users can use the command "cbmc" in their console.<br>
But, Windows users can't run "cbmc" in the default command prompt. Windows users need to install Visual Studio, then use Visual Studio's Developer Command Prompt, to run "cbmc".
Alternatively, Windows users can use WSL to run "cbmc".

Example run (in case of branch: original_heusser_imp in it's default state): 

Block 780000 is set as the block which the program solves by default. It's nonce is: 674152640. In line 292, the nonce range is set to 1k nonces. There are 16 leading zeros assumed from line 404 to line 412. <br>
From line 469 to line 472 is the assertion, which simply checks again the target's last 2 leading zeros (i.e: leading zeros in position 15 and 16 of the hash). When the assertion fails, it means that a valid hash is found.
Therefore, the counterexample, generated by CBMC will contain the valid nonce.

To run CBMC, execute the following command:

```
cbmc satcoin.c -DCBMC --trace > test.txt
```
- satcoin.c is the file which cbmc will analyze. In our case, the hard-coded block will be solved.
- -DCBMC will enable CBMC specific code lines in satcoin.c (__CPROVER_assume, nondet_uint)
- --trace options will generate the counterexample
- \> test.txt is needed because most of the time the counterexample is too long for a cmd. The result will be saved to a text file, named: "test.txt".

By default, you will experience long solving time (many minutes, or more, but this varies). If you decrease the nonce range to 1! nonce, then you will see that nonce in the counterexample.

